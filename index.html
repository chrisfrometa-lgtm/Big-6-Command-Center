<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Big 6 Command Center</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0c0f; --surface: #111318; --surface2: #181c24; --border: #1e2330;
    --accent: #e8c84a; --accent2: #4a9ee8; --red: #e84a4a; --green: #4ae87a;
    --orange: #e8924a; --text: #e8eaf0; --muted: #6b7280;
    --font-display: 'Bebas Neue', sans-serif;
    --font-mono: 'DM Mono', monospace;
    --font-body: 'DM Sans', sans-serif;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: var(--bg); color: var(--text); font-family: var(--font-body); min-height: 100vh; overflow-x: hidden; }

  /* â”€â”€ HEADER â”€â”€ */
  header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 16px 36px; border-bottom: 1px solid var(--border);
    background: var(--surface); position: sticky; top: 0; z-index: 100;
  }
  .logo { font-family: var(--font-display); font-size: 26px; letter-spacing: 3px; color: var(--accent); }
  .logo span { color: var(--text); }
  .nav { display: flex; gap: 4px; }
  .nav-btn {
    background: none; border: 1px solid transparent; color: var(--muted);
    font-family: var(--font-mono); font-size: 11px; letter-spacing: 1.5px;
    text-transform: uppercase; padding: 8px 15px; cursor: pointer; border-radius: 4px; transition: all 0.2s;
  }
  .nav-btn:hover { color: var(--text); border-color: var(--border); }
  .nav-btn.active { color: var(--accent); border-color: var(--accent); background: rgba(232,200,74,0.06); }

  /* â”€â”€ SWEEP STATUS BAR â”€â”€ */
  #sweep-bar {
    display: flex; align-items: center; gap: 12px;
    padding: 8px 36px; border-bottom: 1px solid var(--border);
    background: var(--surface2); font-family: var(--font-mono); font-size: 11px;
    letter-spacing: 1px; min-height: 38px;
  }
  .sweep-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
  .dot-idle    { background: var(--muted); }
  .dot-loading { background: var(--accent); animation: blink 1s infinite; }
  .dot-ok      { background: var(--green); }
  .dot-error   { background: var(--red); }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }
  #sweep-text { color: var(--muted); flex: 1; }
  #sweep-time { color: rgba(107,114,128,0.6); margin-left: auto; }
  .sweep-btn {
    background: none; border: 1px solid var(--border); color: var(--muted);
    font-family: var(--font-mono); font-size: 10px; letter-spacing: 1px; text-transform: uppercase;
    padding: 4px 12px; border-radius: 4px; cursor: pointer; transition: all 0.2s;
  }
  .sweep-btn:hover { border-color: var(--accent); color: var(--accent); }

  /* â”€â”€ API KEY MODAL â”€â”€ */
  #api-modal {
    display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85);
    z-index: 500; align-items: center; justify-content: center;
  }
  #api-modal.open { display: flex; }
  .modal-box {
    background: var(--surface); border: 1px solid var(--border); border-radius: 10px;
    padding: 36px; width: 520px; max-width: 95vw;
  }
  .modal-title { font-family: var(--font-display); font-size: 28px; letter-spacing: 2px; margin-bottom: 8px; }
  .modal-sub { font-family: var(--font-mono); font-size: 11px; color: var(--muted); letter-spacing: 1.5px; margin-bottom: 24px; }
  .modal-label { font-family: var(--font-mono); font-size: 11px; color: var(--muted); letter-spacing: 1px; display: block; margin-bottom: 6px; }
  .modal-input {
    width: 100%; background: var(--surface2); border: 1px solid var(--border); color: var(--text);
    font-family: var(--font-mono); font-size: 13px; padding: 11px 14px;
    border-radius: 6px; outline: none; margin-bottom: 14px; transition: border-color 0.2s;
  }
  .modal-input:focus { border-color: var(--accent); }
  .modal-note { font-size: 12px; color: var(--muted); line-height: 1.6; margin-bottom: 20px; }
  .modal-note a { color: var(--accent2); text-decoration: none; }
  .modal-btns { display: flex; gap: 10px; }
  .btn-primary {
    background: var(--accent); color: #000; border: none; font-family: var(--font-mono);
    font-size: 11px; font-weight: 500; letter-spacing: 2px; text-transform: uppercase;
    padding: 11px 24px; border-radius: 6px; cursor: pointer; transition: background 0.2s;
  }
  .btn-primary:hover { background: #f0d060; }
  .btn-skip {
    background: none; border: 1px solid var(--border); color: var(--muted);
    font-family: var(--font-mono); font-size: 11px; letter-spacing: 1px; text-transform: uppercase;
    padding: 11px 20px; border-radius: 6px; cursor: pointer; transition: all 0.2s;
  }
  .btn-skip:hover { color: var(--text); }

  /* â”€â”€ PANELS â”€â”€ */
  .panel { display: none; padding: 32px 36px; animation: fadeIn 0.3s ease; }
  .panel.active { display: block; }
  @keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:none; } }

  .section-title { font-family: var(--font-display); font-size: 32px; letter-spacing: 3px; margin-bottom: 4px; }
  .section-sub { font-family: var(--font-mono); font-size: 11px; color: var(--muted); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 26px; }

  .card { background: var(--surface); border: 1px solid var(--border); border-radius: 8px; padding: 20px; margin-bottom: 16px; }
  .card-title { font-family: var(--font-mono); font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 14px; }

  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

  /* â”€â”€ INJURY FEED â”€â”€ */
  #injury-feed { display: flex; flex-direction: column; gap: 10px; }
  .feed-item {
    background: var(--surface2); border: 1px solid var(--border); border-radius: 6px;
    padding: 14px 16px; display: flex; gap: 14px; align-items: flex-start;
  }
  .feed-sev { font-family: var(--font-mono); font-size: 10px; letter-spacing: 1px; padding: 3px 8px; border-radius: 3px; white-space: nowrap; margin-top: 2px; flex-shrink: 0; }
  .sev-out     { background: rgba(232,74,74,0.15); color: var(--red); border: 1px solid rgba(232,74,74,0.25); }
  .sev-dtd     { background: rgba(232,146,74,0.15); color: var(--orange); border: 1px solid rgba(232,146,74,0.25); }
  .sev-monitor { background: rgba(232,200,74,0.12); color: var(--accent); border: 1px solid rgba(232,200,74,0.2); }
  .sev-clear   { background: rgba(74,232,122,0.1); color: var(--green); border: 1px solid rgba(74,232,122,0.18); }
  .feed-body { flex: 1; }
  .feed-player { font-weight: 600; font-size: 14px; margin-bottom: 3px; }
  .feed-detail { font-size: 12px; color: var(--muted); line-height: 1.5; }
  .feed-empty { font-family: var(--font-mono); font-size: 12px; color: var(--muted); padding: 20px 0; letter-spacing: 1px; }

  /* â”€â”€ DRAFT BOARD â”€â”€ */
  .draft-controls { display: flex; gap: 10px; margin-bottom: 18px; flex-wrap: wrap; align-items: center; }
  .search-input {
    background: var(--surface2); border: 1px solid var(--border); color: var(--text);
    font-family: var(--font-mono); font-size: 13px; padding: 9px 13px;
    border-radius: 6px; width: 230px; outline: none; transition: border-color 0.2s;
  }
  .search-input:focus { border-color: var(--accent); }
  .search-input::placeholder { color: var(--muted); }
  select.filter-select {
    background: var(--surface2); border: 1px solid var(--border); color: var(--text);
    font-family: var(--font-mono); font-size: 12px; padding: 9px 13px;
    border-radius: 6px; outline: none; cursor: pointer;
  }
  .btn {
    background: var(--accent); color: #000; border: none; font-family: var(--font-mono);
    font-size: 10px; font-weight: 500; letter-spacing: 1.5px; text-transform: uppercase;
    padding: 7px 14px; border-radius: 5px; cursor: pointer; transition: background 0.2s;
  }
  .btn:hover { background: #f0d060; }
  .btn-ghost {
    background: none; border: 1px solid var(--border); color: var(--muted);
    font-family: var(--font-mono); font-size: 10px; letter-spacing: 1px; text-transform: uppercase;
    padding: 7px 13px; border-radius: 5px; cursor: pointer; transition: all 0.2s;
  }
  .btn-ghost:hover { border-color: var(--muted); color: var(--text); }

  .draft-status {
    display: flex; gap: 16px; align-items: center;
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 8px; padding: 12px 20px; margin-bottom: 18px; flex-wrap: wrap;
  }
  .draft-stat { display: flex; flex-direction: column; gap: 2px; }
  .draft-stat-label { font-family: var(--font-mono); font-size: 10px; letter-spacing: 1.5px; color: var(--muted); text-transform: uppercase; }
  .draft-stat-value { font-family: var(--font-display); font-size: 24px; letter-spacing: 2px; color: var(--accent); line-height: 1; }
  .divider-v { width: 1px; height: 34px; background: var(--border); }
  .your-pick-banner {
    background: rgba(232,200,74,0.1); border: 1px solid rgba(232,200,74,0.3);
    border-radius: 5px; padding: 6px 13px; font-family: var(--font-mono); font-size: 12px;
    color: var(--accent); letter-spacing: 1px; display: inline-block; animation: pulse 1.8s infinite;
  }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.5} }

  .player-table { width: 100%; border-collapse: collapse; font-size: 13px; }
  .player-table th {
    font-family: var(--font-mono); font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase;
    color: var(--muted); text-align: left; padding: 9px 10px; border-bottom: 1px solid var(--border);
    cursor: pointer; user-select: none; white-space: nowrap;
  }
  .player-table th:hover { color: var(--accent); }
  .player-table td { padding: 10px 10px; border-bottom: 1px solid rgba(30,35,48,0.5); vertical-align: middle; }
  .player-table tr:hover td { background: rgba(232,200,74,0.025); }
  .player-table tr.drafted td { opacity: 0.28; }
  .player-table tr.my-pick td { background: rgba(74,232,122,0.04); }
  .player-name { font-weight: 500; font-size: 13px; }
  .player-meta { font-family: var(--font-mono); font-size: 10px; color: var(--muted); margin-top: 1px; }

  .pos-badge { font-family: var(--font-mono); font-size: 10px; font-weight: 500; letter-spacing: 1px; padding: 2px 7px; border-radius: 3px; white-space: nowrap; }
  .pos-C  { background: rgba(74,158,232,0.15); color: #4a9ee8; }
  .pos-1B { background: rgba(74,232,122,0.12); color: #4ae87a; }
  .pos-2B { background: rgba(232,200,74,0.12); color: #e8c84a; }
  .pos-3B { background: rgba(232,120,74,0.12); color: #e87a4a; }
  .pos-SS { background: rgba(200,74,232,0.12); color: #c84ae8; }
  .pos-OF { background: rgba(74,200,232,0.12); color: #4ac8e8; }
  .pos-SP { background: rgba(232,74,74,0.12); color: #e84a4a; }
  .pos-RP { background: rgba(160,74,232,0.12); color: #a04ae8; }
  .pos-DH { background: rgba(150,150,150,0.1); color: #aaa; }

  .pts-score { font-family: var(--font-mono); font-weight: 500; font-size: 14px; color: var(--accent); }
  .adp-num { font-family: var(--font-mono); font-size: 12px; color: var(--muted); }
  .value-badge { font-family: var(--font-mono); font-size: 10px; padding: 2px 7px; border-radius: 3px; white-space: nowrap; }
  .value-steal { background: rgba(74,232,122,0.15); color: var(--green); }
  .value-fair  { background: rgba(100,100,100,0.1); color: var(--muted); }
  .value-avoid { background: rgba(232,74,74,0.1); color: var(--red); }

  .inj-badge { font-family: var(--font-mono); font-size: 9px; letter-spacing: 0.5px; padding: 2px 6px; border-radius: 3px; white-space: nowrap; margin-left: 5px; }
  .inj-out     { background: rgba(232,74,74,0.2); color: var(--red); border: 1px solid rgba(232,74,74,0.3); }
  .inj-dtd     { background: rgba(232,146,74,0.2); color: var(--orange); border: 1px solid rgba(232,146,74,0.3); }
  .inj-monitor { background: rgba(232,200,74,0.15); color: var(--accent); border: 1px solid rgba(232,200,74,0.2); }
  .inj-healthy { background: rgba(74,232,122,0.1); color: var(--green); border: 1px solid rgba(74,232,122,0.15); }
  .rank-num { font-family: var(--font-mono); font-size: 12px; color: var(--muted); width: 28px; text-align: right; }
  .table-wrap { overflow-x: auto; }

  .roster-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(185px, 1fr)); gap: 8px; }
  .roster-slot { background: var(--surface2); border: 1px solid var(--border); border-radius: 6px; padding: 10px 12px; display: flex; flex-direction: column; gap: 3px; min-height: 58px; }
  .slot-label  { font-family: var(--font-mono); font-size: 10px; letter-spacing: 1.5px; color: var(--muted); text-transform: uppercase; }
  .slot-player { font-size: 13px; font-weight: 500; }
  .slot-empty  { font-size: 12px; color: rgba(107,114,128,0.4); font-style: italic; }
  .slot-pts    { font-family: var(--font-mono); font-size: 11px; color: var(--accent); }

  .strategy-tip { background: var(--surface2); border-left: 3px solid var(--accent); padding: 12px 16px; margin-bottom: 10px; border-radius: 0 6px 6px 0; font-size: 13px; line-height: 1.6; }
  .strategy-tip strong { color: var(--accent); font-family: var(--font-mono); font-size: 11px; letter-spacing: 1px; text-transform: uppercase; display: block; margin-bottom: 3px; }

  .insight-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px; }
  .insight-card { background: var(--surface2); border: 1px solid var(--border); border-radius: 8px; padding: 18px; }
  .insight-num  { font-family: var(--font-display); font-size: 42px; letter-spacing: 2px; line-height: 1; margin-bottom: 4px; }
  .insight-label { font-family: var(--font-mono); font-size: 11px; letter-spacing: 1.5px; color: var(--muted); text-transform: uppercase; }
  .insight-detail { font-size: 12px; color: var(--muted); margin-top: 8px; line-height: 1.5; }

  .alert { background: rgba(232,200,74,0.05); border: 1px solid rgba(232,200,74,0.18); border-radius: 6px; padding: 12px 16px; font-size: 13px; margin-bottom: 16px; display: flex; align-items: flex-start; gap: 10px; }
  .alert-icon { color: var(--accent); font-size: 15px; margin-top: 1px; }
  .alert-red { background: rgba(232,74,74,0.05); border: 1px solid rgba(232,74,74,0.2); border-radius: 6px; padding: 12px 16px; font-size: 13px; margin-bottom: 16px; }

  .stat-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border); font-size: 13px; }
  .stat-row:last-child { border-bottom: none; }
  .stat-name { color: var(--muted); font-family: var(--font-mono); font-size: 12px; }
  .stat-val { font-family: var(--font-mono); font-weight: 500; font-size: 13px; }
  .pos { color: var(--green); } .neg { color: var(--red); } .high { color: var(--accent); }
  .scoring-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }

  .sub-tabs { display: flex; gap: 4px; margin-bottom: 18px; }
  .sub-tab { background: none; border: 1px solid var(--border); color: var(--muted); font-family: var(--font-mono); font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; padding: 7px 14px; border-radius: 4px; cursor: pointer; transition: all 0.2s; }
  .sub-tab:hover { color: var(--text); }
  .sub-tab.active { color: var(--accent2); border-color: var(--accent2); background: rgba(74,158,232,0.06); }

  ::-webkit-scrollbar { width: 6px; height: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  @media (max-width: 900px) {
    header { padding: 14px 18px; }
    .panel { padding: 20px 16px; }
    .grid-2, .scoring-grid, .insight-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<!-- â”€â”€ API KEY MODAL â”€â”€ -->
<div id="api-modal" class="open">
  <div class="modal-box">
    <div class="modal-title">INJURY SWEEP</div>
    <div class="modal-sub">LIVE MLB INJURY DATA Â· POWERED BY AI</div>
    <label class="modal-label">ANTHROPIC API KEY</label>
    <input type="password" class="modal-input" id="api-key-input" placeholder="sk-ant-..." autocomplete="off">
    <div class="modal-note">
      Your key is stored only in your browser's local storage and never sent anywhere except directly to Anthropic's API to fetch injury news.<br><br>
      Get a free key at <a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a> â†’ API Keys. 
      Cost is fractions of a cent per daily sweep.
    </div>
    <div class="modal-btns">
      <button class="btn-primary" onclick="saveApiKey()">SAVE & SWEEP NOW</button>
      <button class="btn-skip" onclick="skipApiKey()">USE STATIC DATA</button>
    </div>
  </div>
</div>

<header>
  <div class="logo">BIG<span>6</span> CC</div>
  <nav class="nav">
    <button class="nav-btn active" onclick="showPanel('injuries',this)">ğŸ”´ Injuries</button>
    <button class="nav-btn" onclick="showPanel('strategy',this)">Strategy</button>
    <button class="nav-btn" onclick="showPanel('draft',this)">Draft Board</button>
    <button class="nav-btn" onclick="showPanel('lineup',this)">Lineup</button>
    <button class="nav-btn" onclick="showPanel('settings',this)">Settings</button>
  </nav>
  <div style="font-family:var(--font-mono);font-size:11px;color:var(--muted);letter-spacing:1px;">ESPN Â· H2H Â· 6 TEAMS</div>
</header>

<!-- â”€â”€ SWEEP STATUS BAR â”€â”€ -->
<div id="sweep-bar">
  <div class="sweep-dot dot-idle" id="sweep-dot"></div>
  <span id="sweep-text">Injury sweep ready</span>
  <span id="sweep-time"></span>
  <button class="sweep-btn" onclick="runSweep()">â†» SWEEP NOW</button>
  <button class="sweep-btn" onclick="document.getElementById('api-modal').classList.add('open')">âš™ API KEY</button>
</div>

<!-- â•â•â• INJURIES PANEL â•â•â• -->
<div id="panel-injuries" class="panel active">
  <div class="section-title">INJURY REPORT</div>
  <div class="section-sub" id="injury-updated-sub">Sweep runs automatically when you open the app</div>

  <div class="grid-2" style="gap:24px;align-items:start;">
    <div>
      <div class="card-title">Live Injury Feed â€” Fantasy Relevant Players</div>
      <div id="injury-feed">
        <div class="feed-empty">â³ Waiting for sweep to complete...</div>
      </div>
    </div>
    <div>
      <div class="card-title">Your Roster â€” Health Status</div>
      <div id="roster-health">
        <div class="feed-empty" style="font-size:12px;">Draft your team first, then roster health will appear here.</div>
      </div>
      <div class="card-title" style="margin-top:24px;">What the Sweep Checks</div>
      <div class="strategy-tip">
        <strong>Every Time You Open the App</strong>
        Claude searches for the latest MLB injury news across fantasy-relevant players, parses severity (OUT / Day-to-Day / Monitor), and updates your draft board badges automatically.
      </div>
      <div class="strategy-tip">
        <strong>Data Sources It Pulls From</strong>
        Rotoworld, ESPN, FantasyAlarm, CBS Sports, and NBC Sports injury trackers â€” the same sources the pros use, without you having to visit each one.
      </div>
      <div class="strategy-tip">
        <strong>Sweep Cadence</strong>
        Runs once per session when you open the app. Hit â†» SWEEP NOW in the top bar to force a fresh pull any time â€” especially useful draft morning and during the season before you set lineups.
      </div>
    </div>
  </div>
</div>

<!-- â•â•â• STRATEGY PANEL â•â•â• -->
<div id="panel-strategy" class="panel">
  <div class="section-title">DRAFT STRATEGY</div>
  <div class="section-sub">2026 Pre-Season Â· Mar 16 @ 8PM ET</div>

  <div class="alert-red">
    <strong style="font-family:var(--font-mono);font-size:11px;letter-spacing:1px;color:var(--red);">âš  KEY INJURIES HEADING INTO YOUR DRAFT</strong><br><br>
    <span style="font-size:13px;line-height:1.9;">
      <strong style="color:var(--red)">AVOID EARLY (OUT):</strong> Gerrit Cole (Tommy John â€” May/June) Â· Corbin Burnes (TJ â€” All-Star break) Â· Shane Bieber (forearm IL)<br>
      <strong style="color:var(--orange)">DRAFT WITH CAUTION:</strong> Zack Wheeler (TOS surgery, May?) Â· Corbin Carroll (broken hamate) Â· Francisco Lindor (broken hamate) Â· Ronald AcuÃ±a Jr. (ACL recovery)<br>
      <strong style="color:var(--green)">SAFE PICKS:</strong> Ohtani Â· Judge Â· Bobby Witt Jr. Â· Tarik Skubal Â· Paul Skenes Â· RamÃ­rez Â· Julio Rodriguez Â· Framber Valdez
    </span>
  </div>

  <div class="insight-grid">
    <div class="insight-card">
      <div class="insight-num" style="color:var(--red)">SP</div>
      <div class="insight-label">Highest Value Position</div>
      <div class="insight-detail">W(+7)+QS(+5)+6K(+12)+6IP(+18) = <strong style="color:var(--accent)">~42 pts</strong> in one good start. Draft 3 aces, stream the rest. Skubal + Skenes are the safest Round 1/2 SP.</div>
    </div>
    <div class="insight-card">
      <div class="insight-num" style="color:var(--accent)">+5</div>
      <div class="insight-label">Points Per Home Run</div>
      <div class="insight-detail">HR(+4) + TB(+1) = <strong style="color:var(--accent)">+5 per HR</strong>. Most HR also generate R(+1) + RBI(+1) = effectively <strong style="color:var(--accent)">+7 per HR</strong> in run situations. Power is king.</div>
    </div>
    <div class="insight-card">
      <div class="insight-num" style="color:var(--green)">3</div>
      <div class="insight-label">UTIL Slots = Big Edge</div>
      <div class="insight-detail">Draft the best player available â€” UTIL absorbs overflow. Can roster 4 OF + play all of them. Never reach for positional needs in early rounds.</div>
    </div>
    <div class="insight-card">
      <div class="insight-num" style="color:var(--orange)">-1</div>
      <div class="insight-label">Batting K Penalty</div>
      <div class="insight-detail">200 K/season = <strong style="color:var(--red)">-200 pts</strong> vs a contact hitter. Avoid chronic strikeout machines. Ohtani, Judge, RamÃ­rez all have manageable K rates.</div>
    </div>
  </div>

  <div class="grid-2">
    <div>
      <div class="card-title">Round-by-Round Blueprint</div>
      <div class="strategy-tip"><strong>Rounds 1â€“2 Â· Cornerstones</strong>Ohtani, Judge, Bobby Witt Jr., Juan Soto, JosÃ© RamÃ­rez. Only 12 picks go in these rounds â€” your ceiling is set here. No injured players (Cole, Wheeler) in Round 1â€“2.</div>
      <div class="strategy-tip"><strong>Rounds 3â€“5 Â· Aces + Elite Bats</strong>Skubal and Skenes are healthy SP1s worth mid-round picks. Junior Caminero (45 HR at 21!), Julio Rodriguez, Gunnar Henderson, Framber Valdez (DET, CG machine).</div>
      <div class="strategy-tip"><strong>Rounds 6â€“9 Â· SP Depth + Fill Positions</strong>Garrett Crochet, Cristopher SÃ¡nchez, Logan Webb, Bryan Woo (15 W in 2025). Cal Raleigh must be drafted by Round 7 â€” best C in baseball by far.</div>
      <div class="strategy-tip"><strong>Rounds 10â€“15 Â· Closers + Upside</strong>Mason Miller, Ryan Helsley, Emmanuel Clase. Jackson Chourio, Pete Crow-Armstrong as breakout bets. Nick Kurtz (36 HR in 117 rookie games).</div>
      <div class="strategy-tip"><strong>Rounds 16â€“25 Â· IL Stashes + Speculation</strong>Wheeler (IL stash, May return?), RodÃ³n (April/May), Roman Anthony (top prospect debut). Use your 6 IL spots to hold injured players while they recover.</div>
    </div>
    <div>
      <div class="card-title">2026 Sleepers</div>
      <div class="strategy-tip"><strong>Junior Caminero â€” 3B, Tampa Bay</strong>45 HR at age 21. Plate discipline improving. ADP undervalues him â€” could be a top-5 pick by end of 2026. Grab in rounds 3â€“4.</div>
      <div class="strategy-tip"><strong>Nick Kurtz â€” 1B, Oakland</strong>36 HR in only 117 rookie games. Full season = 50+ HR pace. A's lineup is weak but his individual tools are elite.</div>
      <div class="strategy-tip"><strong>Framber Valdez â€” SP, Detroit</strong>Signed with DET â€” better defense, good park. CG threat = CG(+8) stacks with W(+7)+QS(+5)+IPÃ—3. Best CG arm in baseball. Monster ceiling in your format.</div>
      <div class="strategy-tip"><strong>Bryan Woo â€” SP, Seattle</strong>15 wins in 2025. W(+7) volume is real. Mariners park is pitcher-friendly. Massively undervalued in mid-rounds.</div>
      <div class="strategy-tip"><strong>Jackson Chourio â€” OF, Milwaukee</strong>Led off MIL's lineup (2nd in MLB in OBP). R(+1) volume will be elite. Age-22 breakout candidate with SB upside.</div>
    </div>
  </div>
</div>

<!-- â•â•â• DRAFT BOARD â•â•â• -->
<div id="panel-draft" class="panel">
  <div class="section-title">DRAFT BOARD</div>
  <div class="section-sub">Ranked by projected pts in your scoring Â· Live injury badges</div>

  <div class="draft-status">
    <div class="draft-stat"><div class="draft-stat-label">Current Pick</div><div class="draft-stat-value" id="current-pick">1</div></div>
    <div class="divider-v"></div>
    <div class="draft-stat"><div class="draft-stat-label">Round</div><div class="draft-stat-value" id="current-round">1</div></div>
    <div class="divider-v"></div>
    <div class="draft-stat"><div class="draft-stat-label">Drafted</div><div class="draft-stat-value" id="drafted-count">0</div></div>
    <div class="divider-v"></div>
    <div class="draft-stat"><div class="draft-stat-label">My Roster</div><div class="draft-stat-value" id="my-roster-count">0</div></div>
    <div class="divider-v"></div>
    <div style="display:flex;flex-direction:column;gap:4px;">
      <label style="font-family:var(--font-mono);font-size:10px;color:var(--muted);letter-spacing:1px;">MY DRAFT SLOT (1â€“6)</label>
      <input type="number" id="draft-pos-input" min="1" max="6" placeholder="e.g. 3"
        style="background:var(--surface2);border:1px solid var(--border);color:var(--accent);font-family:var(--font-mono);font-size:16px;padding:5px 9px;border-radius:4px;width:80px;outline:none;"
        oninput="setDraftPosition(this.value)">
    </div>
    <div style="flex:1;text-align:right;">
      <div id="pick-banner" class="your-pick-banner" style="display:none;">âš¡ YOUR PICK NOW</div>
      <div id="pick-info" style="font-family:var(--font-mono);font-size:11px;color:var(--muted);letter-spacing:1px;"></div>
    </div>
    <button class="btn-ghost" onclick="resetDraftBoard()">RESET</button>
  </div>

  <div class="draft-controls">
    <input type="text" class="search-input" placeholder="Search player or team..." oninput="renderDraftBoard()" id="draft-search">
    <select class="filter-select" onchange="renderDraftBoard()" id="pos-filter">
      <option value="ALL">All Positions</option>
      <option value="C">Catcher</option>
      <option value="1B">First Base</option>
      <option value="2B">Second Base</option>
      <option value="3B">Third Base</option>
      <option value="SS">Shortstop</option>
      <option value="OF">Outfield</option>
      <option value="SP">Starting Pitcher</option>
      <option value="RP">Relief Pitcher</option>
    </select>
    <select class="filter-select" onchange="renderDraftBoard()" id="avail-filter">
      <option value="available">Available Only</option>
      <option value="all">Show All</option>
    </select>
    <select class="filter-select" onchange="renderDraftBoard()" id="health-filter">
      <option value="all">All Health</option>
      <option value="healthy">Healthy Only</option>
      <option value="risk">Injured / At Risk</option>
    </select>
  </div>

  <div class="grid-2" style="gap:20px;align-items:start;">
    <div>
      <div class="card-title">Players â€” Updated with live injury badges</div>
      <div class="table-wrap">
        <table class="player-table">
          <thead>
            <tr>
              <th>#</th><th>PLAYER</th><th>POS</th>
              <th title="Projected fantasy points in your scoring">PROJ PTS</th>
              <th title="Expert consensus ADP">ADP</th>
              <th title="Value vs ADP">VALUE</th>
              <th>ACTION</th>
            </tr>
          </thead>
          <tbody id="draft-tbody"></tbody>
        </table>
      </div>
    </div>
    <div>
      <div class="card-title">My Roster (<span id="roster-count-label">0</span>/35)</div>
      <div id="my-roster-display" class="roster-grid"></div>
    </div>
  </div>
</div>

<!-- â•â•â• LINEUP PANEL â•â•â• -->
<div id="panel-lineup" class="panel">
  <div class="section-title">LINEUP OPTIMIZER</div>
  <div class="section-sub">Daily start/sit Â· In-season injury flags</div>
  <div class="alert"><span class="alert-icon">ğŸ“‹</span><div>Draft your team first. Once rostered, your full lineup appears here with health badges pulled from the live injury sweep.</div></div>
  <div class="sub-tabs">
    <button class="sub-tab active" onclick="showSubTab('tab-hitters',this)">Hitters</button>
    <button class="sub-tab" onclick="showSubTab('tab-pitchers',this)">Pitchers</button>
    <button class="sub-tab" onclick="showSubTab('tab-tips',this)">In-Season Tips</button>
  </div>
  <div id="tab-hitters"><div class="card-title">Your Hitters</div><div id="lineup-hitters"></div></div>
  <div id="tab-pitchers" style="display:none"><div class="card-title">Your Pitchers</div><div id="lineup-pitchers"></div></div>
  <div id="tab-tips" style="display:none">
    <div class="strategy-tip"><strong>Daily Lineups Lock at Gametime</strong>Check injury reports by 10am ET. Confirm SP are actually starting. Run the sweep every morning before setting lineups.</div>
    <div class="strategy-tip"><strong>SP Streaming (8 acquisitions/matchup)</strong>Use 2â€“3 acquisitions for SP streaming, keep 1â€“2 in reserve for injuries. Don't burn all 8 by Wednesday. Home game + sub-.310 opponent wOBA + ERA below 4.20 = green light stream.</div>
    <div class="strategy-tip"><strong>IL Management â€” 6 Spots</strong>Stash injured players (Wheeler, RodÃ³n) on IL while they rehab. This is free roster space â€” don't leave IL spots empty. Return players are often elite value when they come back healthy.</div>
  </div>
</div>

<!-- â•â•â• SETTINGS â•â•â• -->
<div id="panel-settings" class="panel">
  <div class="section-title">LEAGUE SETTINGS</div>
  <div class="section-sub">2025 Big 6 League Â· ESPN Â· H2H Points</div>
  <div class="scoring-grid">
    <div>
      <div class="card-title">Batting Scoring</div>
      <div class="stat-row"><span class="stat-name">Runs (R)</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">Singles (1B)</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">Doubles (2B)</span><span class="stat-val pos">+2</span></div>
      <div class="stat-row"><span class="stat-name">Triples (3B)</span><span class="stat-val pos">+3</span></div>
      <div class="stat-row"><span class="stat-name">Home Runs (HR)</span><span class="stat-val high">+4</span></div>
      <div class="stat-row"><span class="stat-name">Total Bases (TB)</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">RBI</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">GWRBI</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">Walks (BB)</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">IBB</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">Strikeouts â€” Batting</span><span class="stat-val neg">-1</span></div>
      <div class="stat-row"><span class="stat-name">HBP</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">Stolen Bases (SB)</span><span class="stat-val pos">+1</span></div>
      <div class="stat-row"><span class="stat-name">Caught Stealing (CS)</span><span class="stat-val neg">-1</span></div>
      <div class="stat-row"><span class="stat-name">Hit for Cycle</span><span class="stat-val high">+2</span></div>
      <div class="stat-row"><span class="stat-name">Grand Slam</span><span class="stat-val high">+2</span></div>
    </div>
    <div>
      <div class="card-title">Pitching Scoring</div>
      <div class="stat-row"><span class="stat-name">Innings Pitched (IP)</span><span class="stat-val high">+3</span></div>
      <div class="stat-row"><span class="stat-name">Earned Runs (ER)</span><span class="stat-val neg">-1</span></div>
      <div class="stat-row"><span class="stat-name">Walks Issued (BB)</span><span class="stat-val neg">-1</span></div>
      <div class="stat-row"><span class="stat-name">Strikeouts â€” Pitching</span><span class="stat-val pos">+2</span></div>
      <div class="stat-row"><span class="stat-name">Quality Starts (QS)</span><span class="stat-val high">+5</span></div>
      <div class="stat-row"><span class="stat-name">Complete Games (CG)</span><span class="stat-val high">+8</span></div>
      <div class="stat-row"><span class="stat-name">Shutouts (SHO)</span><span class="stat-val high">+5</span></div>
      <div class="stat-row"><span class="stat-name">No Hitters (NH)</span><span class="stat-val high">+10</span></div>
      <div class="stat-row"><span class="stat-name">Perfect Games (PG)</span><span class="stat-val high">+15</span></div>
      <div class="stat-row"><span class="stat-name">Wins (W)</span><span class="stat-val high">+7</span></div>
      <div class="stat-row"><span class="stat-name">Losses (L)</span><span class="stat-val neg">-5</span></div>
      <div class="stat-row"><span class="stat-name">Saves (SV)</span><span class="stat-val high">+5</span></div>
      <div class="stat-row"><span class="stat-name">Blown Saves (BS)</span><span class="stat-val neg">-3</span></div>
      <div class="stat-row"><span class="stat-name">Holds (HD)</span><span class="stat-val pos">+3</span></div>
    </div>
  </div>
  <div class="grid-2" style="margin-top:20px;">
    <div>
      <div class="card-title">Roster</div>
      <div class="stat-row"><span class="stat-name">C / 1B / 2B / 3B / SS</span><span class="stat-val">1 each</span></div>
      <div class="stat-row"><span class="stat-name">OF</span><span class="stat-val">4 starters</span></div>
      <div class="stat-row"><span class="stat-name">DH</span><span class="stat-val">1 starter</span></div>
      <div class="stat-row"><span class="stat-name">UTIL</span><span class="stat-val">3 starters</span></div>
      <div class="stat-row"><span class="stat-name">SP / RP</span><span class="stat-val">8 / 2 starters</span></div>
      <div class="stat-row"><span class="stat-name">Bench / IL</span><span class="stat-val">13 / 6 spots</span></div>
    </div>
    <div>
      <div class="card-title">League</div>
      <div class="stat-row"><span class="stat-name">Teams</span><span class="stat-val">6</span></div>
      <div class="stat-row"><span class="stat-name">Draft</span><span class="stat-val" style="color:var(--accent)">Snake Â· Mar 16 @ 8PM ET</span></div>
      <div class="stat-row"><span class="stat-name">Lineup Changes</span><span class="stat-val">Daily at gametime</span></div>
      <div class="stat-row"><span class="stat-name">Acquisitions</span><span class="stat-val">8 per matchup</span></div>
      <div class="stat-row"><span class="stat-name">Trade Deadline</span><span class="stat-val">Aug 31, 2026</span></div>
      <div class="stat-row"><span class="stat-name">Playoffs</span><span class="stat-val">4 of 6 teams</span></div>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PLAYER DATABASE â€” 2025 stats + 2026 projections
// inj: healthy | monitor | dtd | out
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PLAYERS = [
  {id:1,  name:"Shohei Ohtani",       team:"LAD", pos:"OF", adp:1,  proj:740, inj:"healthy", injNote:""},
  {id:2,  name:"Aaron Judge",         team:"NYY", pos:"OF", adp:2,  proj:700, inj:"healthy", injNote:""},
  {id:3,  name:"Bobby Witt Jr.",      team:"KC",  pos:"SS", adp:3,  proj:660, inj:"healthy", injNote:""},
  {id:4,  name:"Juan Soto",           team:"NYM", pos:"OF", adp:4,  proj:640, inj:"healthy", injNote:""},
  {id:5,  name:"JosÃ© RamÃ­rez",        team:"CLE", pos:"3B", adp:5,  proj:640, inj:"healthy", injNote:""},
  {id:6,  name:"Elly De La Cruz",     team:"CIN", pos:"SS", adp:6,  proj:610, inj:"healthy", injNote:""},
  {id:7,  name:"Tarik Skubal",        team:"DET", pos:"SP", adp:7,  proj:610, inj:"healthy", injNote:""},
  {id:8,  name:"Ronald AcuÃ±a Jr.",    team:"ATL", pos:"OF", adp:10, proj:580, inj:"monitor", injNote:"2nd ACL recovery â€” monitor spring 2026"},
  {id:9,  name:"Paul Skenes",         team:"PIT", pos:"SP", adp:9,  proj:590, inj:"healthy", injNote:""},
  {id:10, name:"Kyle Tucker",         team:"LAD", pos:"OF", adp:11, proj:580, inj:"healthy", injNote:""},
  {id:11, name:"Julio Rodriguez",     team:"SEA", pos:"OF", adp:8,  proj:570, inj:"healthy", injNote:""},
  {id:12, name:"Garrett Crochet",     team:"BOS", pos:"SP", adp:12, proj:555, inj:"healthy", injNote:""},
  {id:13, name:"Gunnar Henderson",    team:"BAL", pos:"SS", adp:13, proj:560, inj:"healthy", injNote:""},
  {id:14, name:"Junior Caminero",     team:"TB",  pos:"3B", adp:14, proj:555, inj:"healthy", injNote:""},
  {id:15, name:"Fernando Tatis Jr.",  team:"SD",  pos:"OF", adp:15, proj:540, inj:"healthy", injNote:""},
  {id:16, name:"Jackson Chourio",     team:"MIL", pos:"OF", adp:16, proj:520, inj:"healthy", injNote:""},
  {id:17, name:"Pete Crow-Armstrong", team:"CHC", pos:"OF", adp:17, proj:490, inj:"healthy", injNote:""},
  {id:18, name:"Cal Raleigh",         team:"SEA", pos:"C",  adp:17, proj:480, inj:"healthy", injNote:""},
  {id:19, name:"Yoshinobu Yamamoto",  team:"LAD", pos:"SP", adp:20, proj:500, inj:"healthy", injNote:""},
  {id:20, name:"Framber Valdez",      team:"DET", pos:"SP", adp:21, proj:530, inj:"healthy", injNote:""},
  {id:21, name:"Cristopher Sanchez",  team:"PHI", pos:"SP", adp:24, proj:520, inj:"healthy", injNote:""},
  {id:22, name:"Jazz Chisholm Jr.",   team:"NYY", pos:"3B", adp:23, proj:470, inj:"healthy", injNote:""},
  {id:23, name:"Pete Alonso",         team:"BAL", pos:"1B", adp:22, proj:490, inj:"healthy", injNote:""},
  {id:24, name:"Nick Kurtz",          team:"OAK", pos:"1B", adp:16, proj:510, inj:"healthy", injNote:""},
  {id:25, name:"Corbin Carroll",      team:"ARI", pos:"OF", adp:21, proj:380, inj:"dtd",     injNote:"Broken hamate (R hand) â€” Opening Day uncertain, power likely reduced"},
  {id:26, name:"Francisco Lindor",    team:"NYM", pos:"SS", adp:27, proj:380, inj:"dtd",     injNote:"Broken hamate (R hand) â€” Opening Day uncertain, switch hitter helps recovery"},
  {id:27, name:"Corey Seager",        team:"TEX", pos:"SS", adp:24, proj:460, inj:"healthy", injNote:"Normal offseason, healthy"},
  {id:28, name:"Trea Turner",         team:"PHI", pos:"SS", adp:26, proj:470, inj:"healthy", injNote:""},
  {id:29, name:"Zach Neto",           team:"LAA", pos:"SS", adp:25, proj:440, inj:"monitor", injNote:"Shoulder surgery Nov 2025 â€” status unclear"},
  {id:30, name:"Rafael Devers",       team:"BOS", pos:"3B", adp:20, proj:480, inj:"healthy", injNote:""},
  {id:31, name:"Manny Machado",       team:"SD",  pos:"3B", adp:33, proj:445, inj:"healthy", injNote:""},
  {id:32, name:"Alex Bregman",        team:"â€”",   pos:"3B", adp:15, proj:490, inj:"healthy", injNote:""},
  {id:33, name:"Vlad Guerrero Jr.",   team:"TOR", pos:"1B", adp:19, proj:490, inj:"healthy", injNote:""},
  {id:34, name:"Freddie Freeman",     team:"LAD", pos:"1B", adp:29, proj:460, inj:"healthy", injNote:""},
  {id:35, name:"Matt Olson",          team:"ATL", pos:"1B", adp:30, proj:455, inj:"healthy", injNote:""},
  {id:36, name:"Ketel Marte",         team:"ARI", pos:"2B", adp:28, proj:460, inj:"healthy", injNote:""},
  {id:37, name:"Jose Altuve",         team:"HOU", pos:"2B", adp:50, proj:400, inj:"healthy", injNote:""},
  {id:38, name:"William Contreras",   team:"MIL", pos:"C",  adp:30, proj:390, inj:"healthy", injNote:""},
  {id:39, name:"Adley Rutschman",     team:"BAL", pos:"C",  adp:36, proj:370, inj:"healthy", injNote:""},
  {id:40, name:"Kyle Schwarber",      team:"PHI", pos:"DH", adp:18, proj:510, inj:"healthy", injNote:""},
  {id:41, name:"Yordan Alvarez",      team:"HOU", pos:"DH", adp:11, proj:570, inj:"monitor", injNote:"Injury history â€” monitor spring 2026"},
  {id:42, name:"Mookie Betts",        team:"LAD", pos:"OF", adp:18, proj:530, inj:"monitor", injNote:"Injury history â€” monitor spring"},
  {id:43, name:"James Wood",          team:"WSH", pos:"OF", adp:42, proj:435, inj:"healthy", injNote:""},
  {id:44, name:"Jarren Duran",        team:"BOS", pos:"OF", adp:43, proj:430, inj:"healthy", injNote:""},
  {id:45, name:"Logan Webb",          team:"SF",  pos:"SP", adp:44, proj:490, inj:"healthy", injNote:""},
  {id:46, name:"Bryan Woo",           team:"SEA", pos:"SP", adp:40, proj:475, inj:"healthy", injNote:""},
  {id:47, name:"Chris Sale",          team:"ATL", pos:"SP", adp:41, proj:440, inj:"monitor", injNote:"Age 37 â€” fewer than 30 starts likely"},
  {id:48, name:"Luis Castillo",       team:"SEA", pos:"SP", adp:52, proj:430, inj:"healthy", injNote:""},
  {id:49, name:"Zac Gallen",          team:"ARI", pos:"SP", adp:56, proj:415, inj:"healthy", injNote:""},
  {id:50, name:"Joe Ryan",            team:"MIN", pos:"SP", adp:58, proj:420, inj:"healthy", injNote:"Shoulder non-issue per team"},
  {id:51, name:"Zack Wheeler",        team:"PHI", pos:"SP", adp:55, proj:280, inj:"out",     injNote:"TOS surgery Sept 2025 â€” out Opening Day, May/June return"},
  {id:52, name:"Gerrit Cole",         team:"NYY", pos:"SP", adp:60, proj:190, inj:"out",     injNote:"Tommy John surgery â€” expected return May/June 2026"},
  {id:53, name:"Shane Bieber",        team:"TOR", pos:"SP", adp:65, proj:250, inj:"out",     injNote:"Right forearm fatigue â€” starting 2026 on IL"},
  {id:54, name:"Carlos RodÃ³n",        team:"NYY", pos:"SP", adp:60, proj:300, inj:"out",     injNote:"Elbow surgery Oct 2025 â€” targeting April/May return"},
  {id:55, name:"Mason Miller",        team:"OAK", pos:"RP", adp:14, proj:335, inj:"healthy", injNote:""},
  {id:56, name:"Emmanuel Clase",      team:"CLE", pos:"RP", adp:47, proj:305, inj:"monitor", injNote:"Shoulder discomfort early 2025 â€” monitor spring 2026"},
  {id:57, name:"Ryan Helsley",        team:"STL", pos:"RP", adp:50, proj:315, inj:"healthy", injNote:""},
  {id:58, name:"Josh Hader",          team:"HOU", pos:"RP", adp:53, proj:275, inj:"dtd",     injNote:"Biceps tendinitis â€” behind in spring, Opening Day uncertain"},
  {id:59, name:"Devin Williams",      team:"MIL", pos:"RP", adp:57, proj:290, inj:"healthy", injNote:""},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let draftedIds   = new Set();
let myRosterIds  = new Set();
let myDraftPos   = null;
let currentPickNum = 1;
let liveInjuries = []; // populated by sweep

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// API KEY MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveApiKey() {
  const key = document.getElementById('api-key-input').value.trim();
  if (!key.startsWith('sk-ant-')) {
    alert('Key should start with sk-ant-');
    return;
  }
  localStorage.setItem('b6_api_key', key);
  document.getElementById('api-modal').classList.remove('open');
  runSweep();
}
function skipApiKey() {
  document.getElementById('api-modal').classList.remove('open');
  setSweepStatus('idle', 'Running with static data â€” add API key for live injury updates');
}
function getApiKey() { return localStorage.getItem('b6_api_key'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INJURY SWEEP â€” calls Claude API with web_search tool
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setSweepStatus(state, msg) {
  const dot  = document.getElementById('sweep-dot');
  const text = document.getElementById('sweep-text');
  dot.className = 'sweep-dot';
  if (state === 'loading') { dot.classList.add('dot-loading'); text.style.color = 'var(--accent)'; }
  else if (state === 'ok')  { dot.classList.add('dot-ok');      text.style.color = 'var(--green)'; }
  else if (state === 'error'){ dot.classList.add('dot-error');  text.style.color = 'var(--red)'; }
  else { dot.classList.add('dot-idle'); text.style.color = 'var(--muted)'; }
  text.textContent = msg;
}

async function runSweep() {
  const key = getApiKey();
  if (!key) {
    document.getElementById('api-modal').classList.add('open');
    return;
  }

  setSweepStatus('loading', 'Sweeping for MLB injury news...');
  document.getElementById('injury-feed').innerHTML = '<div class="feed-empty">â³ Fetching live injury data...</div>';

  const playerList = PLAYERS.map(p => p.name).join(', ');

  try {
    const res = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', 'x-api-key': key, 'anthropic-version': '2023-06-01' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 2000,
        tools: [{ type: 'web_search_20250305', name: 'web_search' }],
        system: `You are a fantasy baseball injury analyst. Today's date is ${new Date().toLocaleDateString('en-US', {month:'long',day:'numeric',year:'numeric'})}.
Search for the latest MLB injury news for these specific players: ${playerList}.
Return ONLY a JSON array. No prose, no markdown, just the raw JSON array.
Each object must have exactly these fields:
  "player": string (exact name from the list),
  "team": string (3-letter abbreviation),
  "status": one of "out" | "dtd" | "monitor" | "healthy",
  "detail": string (brief plain English injury note, max 80 chars),
  "source": string (where you found this)
Only include players with news in the last 7 days OR players known to be injured/recovering heading into 2026 spring training. Skip players with no injury news.`,
        messages: [{ role: 'user', content: 'Search for the latest MLB injury news and return the JSON array as instructed. Check the most recent sources available.' }]
      })
    });

    if (!res.ok) {
      const err = await res.json();
      throw new Error(err.error?.message || `API error ${res.status}`);
    }

    const data = await res.json();

    // Extract text from response (may be after tool use blocks)
    let rawText = '';
    for (const block of (data.content || [])) {
      if (block.type === 'text') rawText += block.text;
    }

    // Parse JSON from response
    const jsonMatch = rawText.match(/\[[\s\S]*\]/);
    if (!jsonMatch) throw new Error('Could not parse injury data from response');
    const injuries = JSON.parse(jsonMatch[0]);

    liveInjuries = injuries;
    applyInjuriesToPlayers(injuries);
    renderInjuryFeed(injuries);
    renderDraftBoard();
    renderRosterHealth();

    const now = new Date().toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit'});
    document.getElementById('sweep-time').textContent = `Last updated: ${now}`;
    document.getElementById('injury-updated-sub').textContent = `Live data Â· Updated ${now}`;
    setSweepStatus('ok', `Sweep complete â€” ${injuries.length} players with injury news found`);

  } catch (err) {
    console.error('Sweep error:', err);
    setSweepStatus('error', `Sweep failed: ${err.message} â€” using static data`);
    renderInjuryFeed(null);
  }
}

function applyInjuriesToPlayers(injuries) {
  injuries.forEach(inj => {
    const p = PLAYERS.find(pl => pl.name.toLowerCase() === inj.player.toLowerCase());
    if (p) {
      p.inj = inj.status;
      p.injNote = inj.detail;
    }
  });
}

function renderInjuryFeed(injuries) {
  const feed = document.getElementById('injury-feed');
  if (!injuries || injuries.length === 0) {
    // Show static known injuries if sweep failed or returned nothing
    const known = PLAYERS.filter(p => p.inj !== 'healthy');
    if (known.length === 0) { feed.innerHTML = '<div class="feed-empty">No injury news found.</div>'; return; }
    feed.innerHTML = known.map(p => feedItem(p.name, p.team, p.inj, p.injNote, 'Built-in data')).join('');
    return;
  }
  const sorted = [...injuries].sort((a,b) => {
    const order = {out:0, dtd:1, monitor:2, healthy:3};
    return (order[a.status]??3) - (order[b.status]??3);
  });
  feed.innerHTML = sorted.map(i => feedItem(i.player, i.team, i.status, i.detail, i.source)).join('');
}

function feedItem(name, team, status, detail, source) {
  const cls = {out:'sev-out', dtd:'sev-dtd', monitor:'sev-monitor', healthy:'sev-clear'};
  const lbl = {out:'OUT', dtd:'DAY-TO-DAY', monitor:'MONITOR', healthy:'CLEAR'};
  return `<div class="feed-item">
    <span class="feed-sev ${cls[status]||'sev-monitor'}">${lbl[status]||status.toUpperCase()}</span>
    <div class="feed-body">
      <div class="feed-player">${name} <span style="font-family:var(--font-mono);font-size:11px;color:var(--muted);font-weight:400;">${team}</span></div>
      <div class="feed-detail">${detail}${source ? ` <span style="opacity:0.5">Â· ${source}</span>` : ''}</div>
    </div>
  </div>`;
}

function renderRosterHealth() {
  const mine = PLAYERS.filter(p => myRosterIds.has(p.id));
  const el = document.getElementById('roster-health');
  if (mine.length === 0) {
    el.innerHTML = '<div class="feed-empty" style="font-size:12px;">Draft your team first.</div>';
    return;
  }
  const sorted = [...mine].sort((a,b) => {
    const o = {out:0,dtd:1,monitor:2,healthy:3};
    return (o[a.inj]??3) - (o[b.inj]??3);
  });
  el.innerHTML = sorted.map(p => feedItem(p.name, p.team, p.inj, p.injNote || 'No injury news', '')).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPanel(name, btn) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('panel-' + name).classList.add('active');
  if (btn) btn.classList.add('active');
  if (name === 'draft') renderDraftBoard();
  if (name === 'lineup') { renderLineup(); renderRosterHealth(); }
}
function showSubTab(id, btn) {
  document.querySelectorAll('[id^="tab-"]').forEach(t => t.style.display = 'none');
  document.querySelectorAll('.sub-tab').forEach(b => b.classList.remove('active'));
  document.getElementById(id).style.display = 'block';
  btn.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DRAFT BOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function injBadge(p) {
  if (!p.inj || p.inj === 'healthy') return '';
  const m = {out:'inj-out OUT', dtd:'inj-dtd DTD', monitor:'inj-monitor MONITOR'};
  const parts = (m[p.inj] || 'inj-monitor MONITOR').split(' ');
  return `<span class="inj-badge ${parts[0]}" title="${p.injNote}">${parts[1]}</span>`;
}
function getRank(id) { return [...PLAYERS].sort((a,b)=>b.proj-a.proj).findIndex(p=>p.id===id)+1; }
function getValueLabel(p) {
  const diff = p.adp - getRank(p.id);
  if (diff > 8)  return {label:'STEAL', cls:'value-steal'};
  if (diff < -12) return {label:'REACH', cls:'value-avoid'};
  return {label:'FAIR', cls:'value-fair'};
}

function renderDraftBoard() {
  const search      = (document.getElementById('draft-search')?.value||'').toLowerCase();
  const posFilter   = document.getElementById('pos-filter')?.value||'ALL';
  const availFilter = document.getElementById('avail-filter')?.value||'available';
  const healthFilter= document.getElementById('health-filter')?.value||'all';

  const ranked = [...PLAYERS].sort((a,b)=>b.proj-a.proj).map((p,i)=>({...p,rank:i+1}));
  const filtered = ranked.filter(p => {
    if (search && !p.name.toLowerCase().includes(search) && !p.team.toLowerCase().includes(search)) return false;
    if (posFilter !== 'ALL' && p.pos !== posFilter) return false;
    if (availFilter === 'available' && draftedIds.has(p.id)) return false;
    if (healthFilter === 'healthy' && p.inj !== 'healthy') return false;
    if (healthFilter === 'risk' && p.inj === 'healthy') return false;
    return true;
  });

  document.getElementById('draft-tbody').innerHTML = filtered.map(p => {
    const v = getValueLabel(p);
    const isDrafted = draftedIds.has(p.id);
    const isMine    = myRosterIds.has(p.id);
    return `<tr class="${isDrafted?(isMine?'my-pick':'drafted'):''}" id="row-${p.id}">
      <td class="rank-num">${p.rank}</td>
      <td>
        <div class="player-name">${p.name}${injBadge(p)}</div>
        <div class="player-meta">${p.team}</div>
      </td>
      <td><span class="pos-badge pos-${p.pos}">${p.pos}</span></td>
      <td><span class="pts-score">${p.proj}</span></td>
      <td><span class="adp-num">${p.adp}</span></td>
      <td><span class="value-badge ${v.cls}">${v.label}</span></td>
      <td style="display:flex;gap:5px;">
        ${!isDrafted
          ? `<button class="btn" style="padding:4px 10px;font-size:10px;" onclick="draftPick(${p.id},'mine')">MINE</button>
             <button class="btn-ghost" style="padding:4px 9px;" onclick="draftPick(${p.id},'other')">TAKEN</button>`
          : `<span style="font-family:var(--font-mono);font-size:11px;color:${isMine?'var(--green)':'var(--muted)'};">${isMine?'âœ“ YOURS':'DRAFTED'}</span>`}
      </td>
    </tr>`;
  }).join('');
  renderMyRoster();
}

function draftPick(id, type) {
  draftedIds.add(id); currentPickNum++;
  if (type==='mine') myRosterIds.add(id);
  document.getElementById('current-pick').textContent  = currentPickNum;
  document.getElementById('current-round').textContent = Math.ceil(currentPickNum/6);
  document.getElementById('drafted-count').textContent = draftedIds.size;
  document.getElementById('my-roster-count').textContent = myRosterIds.size;
  checkPickBanner(); renderDraftBoard(); renderRosterHealth();
}
function checkPickBanner() {
  if (!myDraftPos) return;
  const round = Math.ceil(currentPickNum/6);
  const pos   = ((currentPickNum-1)%6)+1;
  const snake = round%2===0 ? (7-pos) : pos;
  const mine  = snake === parseInt(myDraftPos);
  document.getElementById('pick-banner').style.display = mine ? 'inline-block' : 'none';
  document.getElementById('pick-info').textContent = mine ? '' : `Pick ${currentPickNum} Â· Round ${round} Â· Slot ${snake}`;
}
function setDraftPosition(v) { myDraftPos=v; checkPickBanner(); }
function resetDraftBoard() {
  if (!confirm('Reset draft board? All picks cleared.')) return;
  draftedIds.clear(); myRosterIds.clear(); currentPickNum=1;
  ['current-pick','current-round','drafted-count','my-roster-count'].forEach(id => document.getElementById(id).textContent = id==='current-pick'?1:0);
  renderDraftBoard();
}

function renderMyRoster() {
  const mine = PLAYERS.filter(p=>myRosterIds.has(p.id)).sort((a,b)=>b.proj-a.proj);
  document.getElementById('roster-count-label').textContent = mine.length;
  const slotDefs = [
    ['C','C'],['1B','1B'],['2B','2B'],['3B','3B'],['SS','SS'],
    ['OF 1','OF'],['OF 2','OF'],['OF 3','OF'],['OF 4','OF'],
    ['DH','DH'],['UTIL 1','UTIL'],['UTIL 2','UTIL'],['UTIL 3','UTIL'],
    ['SP 1','SP'],['SP 2','SP'],['SP 3','SP'],['SP 4','SP'],['SP 5','SP'],['SP 6','SP'],['SP 7','SP'],['SP 8','SP'],
    ['RP 1','RP'],['RP 2','RP']
  ];
  const used = new Set();
  const assigns = slotDefs.map(([label, pos]) => {
    const p = mine.find(pl => !used.has(pl.id) && (
      pl.pos===pos ||
      (pos==='UTIL' && ['1B','2B','3B','SS','OF','DH'].includes(pl.pos)) ||
      (pos==='DH'   && ['DH','OF','1B'].includes(pl.pos))
    ));
    if (p) used.add(p.id);
    return {label, p};
  });
  const bench = mine.filter(p=>!used.has(p.id));
  document.getElementById('my-roster-display').innerHTML = [
    ...assigns.map(({label,p}) => `<div class="roster-slot">
      <div class="slot-label">${label}</div>
      ${p ? `<div class="slot-player">${p.name}${injBadge(p)}</div><div class="slot-pts">~${p.proj} pts</div>`
          : `<div class="slot-empty">â€” empty â€”</div>`}
    </div>`),
    ...bench.map(p => `<div class="roster-slot" style="border-color:rgba(107,114,128,0.2)">
      <div class="slot-label" style="color:rgba(107,114,128,0.4)">BENCH</div>
      <div class="slot-player">${p.name}${injBadge(p)}</div><div class="slot-pts">~${p.proj} pts</div>
    </div>`)
  ].join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LINEUP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderLineup() {
  const mine = PLAYERS.filter(p=>myRosterIds.has(p.id));
  const h  = mine.filter(p=>!['SP','RP'].includes(p.pos)).sort((a,b)=>b.proj-a.proj);
  const pi = mine.filter(p=>['SP','RP'].includes(p.pos)).sort((a,b)=>b.proj-a.proj);
  const tbl = arr => arr.length===0
    ? `<div style="color:var(--muted);font-family:var(--font-mono);font-size:12px;padding:14px 0;">Draft players first.</div>`
    : `<table class="player-table"><thead><tr><th>Player</th><th>Pos</th><th>Proj Pts</th><th>Health</th></tr></thead><tbody>
      ${arr.map(p=>`<tr><td><strong>${p.name}</strong><br><span class="player-meta">${p.team}</span></td>
        <td><span class="pos-badge pos-${p.pos}">${p.pos}</span></td>
        <td><span class="pts-score">${p.proj}</span></td>
        <td><span class="inj-badge ${p.inj==='healthy'?'inj-healthy':p.inj==='out'?'inj-out':p.inj==='dtd'?'inj-dtd':'inj-monitor'}" title="${p.injNote}">${p.inj.toUpperCase()}</span></td>
      </tr>`).join('')}</tbody></table>`;
  document.getElementById('lineup-hitters').innerHTML  = tbl(h);
  document.getElementById('lineup-pitchers').innerHTML = tbl(pi);
  renderRosterHealth();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT â€” check if key exists, auto-sweep or show modal
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function init() {
  const key = getApiKey();
  if (key) {
    document.getElementById('api-key-input').value = key;
    document.getElementById('api-modal').classList.remove('open');
    setSweepStatus('loading', 'Auto-sweeping for injury updates...');
    runSweep();
  } else {
    setSweepStatus('idle', 'Add your API key to enable live injury sweeps');
  }
  renderDraftBoard();
})();
</script>
</body>
</html>
